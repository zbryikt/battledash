ldc.register("period",[],function(){var e,t,n,i;return e={period:["預設","提案期","審查期","決選發表"],selected:0,config:{}},t=function(){return n.update(e.config)},n=new ctrlz({obj:JSON.parse(JSON.stringify(e.config))}),i=new ldView({root:document,action:{input:{time:function(n){var i,r,d,o;return i=n.node,n.evt,r=(d=e.config)[o=e.selected]||(d[o]={}),r[i.getAttribute("ld")]=i.value,t()},name:function(n){var r;return r=n.node,n.evt,e.period[e.selected]=r.value,i.render("period"),t()}},click:{nav:function(t){var n,r,d,o,a;return t.node,n=t.evt,(r=n.target.getAttribute("data-name"))?(ld$.find(i.get("nav"),".nav-link.active",0).classList.remove("active"),n.target.classList.add("active"),e.selected=e.period.indexOf(r),d=(o=e.config)[a=e.selected]||(o[a]={}),i.getAll("switch").map(function(e){return e.classList.toggle("on",null!=d[e.getAttribute("data-name")])}),i.get("default").classList.toggle("d-none",0!==e.selected),i.getAll("custom").map(function(t){return t.classList.toggle("d-none",0===e.selected)}),i.getAll("time").map(function(e){return e.value=d[e.getAttribute("ld")]||""}),i.get("name").value=r):(e.period.push(r="未命名"+e.period.length),void i.render("period"))},switch:function(n){var i,r,d,o;return i=n.node,n.evt,i.classList.toggle("on"),r=(d=e.config)[o=e.selected]||(d[o]={}),r[i.getAttribute("data-name")]=i.classList.contains("on"),t()},delete:function(){var t;if(e.selected)return delete e.period[e.period[e.selected]],e.period.splice(e.selected,1),e.selected<=(t=e.period.length-1)||(e.selected=t),i.render("period")}}},init:{time:function(e){var t;return t=e.node,flatpickr(t,{enableTime:!0,dateFormat:"Y-m-d H:i"})}},handler:{default:function(){},custom:function(){},switch:function(t){var n,i,r;return(n=t.node).classList.toggle("on",!!((i=e.config)[r=e.selected]||(i[r]={}))[n.getAttribute("data-name")])},period:{list:function(){return e.period},handle:function(t){var n,i,r,d;return n=t.node,i=t.data,r=t.idx,d=n.childNodes[0],d.innerText=i,d.classList.toggle("active",r===e.selected),d.setAttribute("data-name",i),d}}}}),document.addEventListener("keydown",function(t){var r;if(90===t.keyCode&&(t.metaKey||t.ctrlKey))return t.shiftKey?n.redo():n.undo(),r=JSON.parse(JSON.stringify(n.get())),e.config=r,i.render()})}),ldc.app("period");